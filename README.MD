# YACONSTRIP - Yet Another CONsent STRIng Parser

Universal Consent String Parsing

![YACONSTRIP](docs/header.png)

Q:What?
A: IAB TCF Consent String Parser, yeah... another one, but it works, in multiple languages.

Q:Why? 
A: Many of the existing TC String parsers are abandonned projects, or they do not comply
with the latest IAB TCF specifications. When the specification changes, you can make sure that
99% of the repos are outdated and it takes months, years or never to have them updated.

Instead, let's create a single source of truth, and generate parsers in many languages to make TC String parsing universal.

## Visual representation of the TC String
TC String structure: `[CORE].[DISCLOSED_VENDORS].[PUBLISHER_RESTRICTIONS]` or `[CORE].[PUBLISHER_RESTRICTIONS]` or `[CORE]`

### Core:

![](docs/core_string.svg)


### Disclosed Vendors:

![](docs/disclosed_vendors.svg)

### Publisher Purposes Transparency and Consent:

![](docs/publisher_tc.svg)

## Key Features üéØ
- **One ring... to rule them all**: One code, many languages:
    - C++/STL
    - C#
    - Go 
    - Java
    - JavaScript
    - Lua
    - Nim 
    - Perl
    - PHP
    - Python
    - Ruby
- **Easy to maintain**: IAB updated their guidelines? No problem, update the _.ksy_ definition files then use the compiler to re-build the modules.


## Roadmap üéØ
- Add encoding examples
- Add more examples
- Provide plug n play modules

## Getting Started üöÄ

Follow these instructions to get a copy of the project up and running on your local machine for development and testing purposes.

### Prerequisites üìã

Ensure you have the following installed:
- Python 3
- [Kaitai Struct Compiler](https://kaitai.io/#download)

Optionally, you might want the [Kaitai Struct Visualizer](https://github.com/kaitai-io/kaitai_struct_visualizer)

### Installation Steps üíΩ

Step 1: Clone this repository:

```bash
git clone https://github.com/angulartist/yaconstrip.git && cd yaconstrip
```

Step 2: Import the modules you want from `modules/`

### Compile the .ksy files

```bash
# language specific
kaitai-struct-compiler --outdir [path/to/output/dir] -t [language] [path/to/.ksy/files]

# example (compile .ksy for Javascript)
kaitai-struct-compiler --outdir examples/javascript/compiled_ksy -t javascript kaitai/*

# or, build modules for all supported languages
./compile-all.sh
```

## Examples ‚ú®

You can find some inspirations in the [examples](examples/) folder.

## Contributors ‚ú®

Thanks go to these wonderful people:
<a href="https://github.com/angulartist/yaconstrip/graphs/contributors">
  <img src="https://contrib.rocks/image?repo=angulartist/yaconstrip" />
</a>

## Contribute ü§ù

Got a pull request? Open it, and we'll review it as soon as possible.

- [Open Issues](https://github.com/angulartist/yaconstrip/issues)
- [Open Pull Requests](https://github.com/angulartist/yaconstrip/pulls)

## Resources üìã

- IAB TCF DOC : [Official IAB TCF Consent String Documentation](https://github.com/InteractiveAdvertisingBureau/GDPR-Transparency-and-Consent-Framework/blob/master/TCFv2/IAB%20Tech%20Lab%20-%20Consent%20string%20and%20vendor%20list%20formats%20v2.md)
- About Kaitai Struct : https://kaitai.io/